# Deployment Comparison: WSL2 vs Coolify

This n8n installation supports two deployment forms. This document provides a side-by-side comparison to help you choose the right approach.

> **Custom Fork Optimized**: Both deployment forms are designed and optimized to run with our custom n8n fork at [github.com/moshehbenavraham/n8n](https://github.com/moshehbenavraham/n8n). The fork enables custom branding and white-labeling while maintaining full compatibility with this deployment infrastructure.

---

## Quick Reference

| Aspect | WSL2 (Local) | Coolify (Cloud) |
|--------|--------------|-----------------|
| **Status** | Operational | Planning |
| **Primary Use** | Development, local automation | Production, cloud-hosted |
| **Docker Compose File** | `docker-compose.yml` | `docker-compose.coolify.yml` |
| **External URL** | https://your.ngrok.domain | https://n8n.aiwithapex.com |
| **Documentation** | [n8n-installation-plan.md](n8n-installation-plan.md) | [deploy-to-coolify.md](ongoing-roadmap/deploy-to-coolify.md) |

---

## Deployment Overview

### WSL2 (Local Development)

**Target Audience**: Developers running n8n on a Windows machine with WSL2

**Architecture**:
```
Internet → ngrok Edge (OAuth) → WSL2 Docker → n8n Stack
```

**Key Characteristics**:
- Runs on local machine (Windows with WSL2 Ubuntu)
- Uses ngrok tunnel for external access with OAuth protection
- Best for development, testing, and personal automation
- Lower latency for local workflows
- No cloud hosting costs

### Coolify (Cloud Production)

**Target Audience**: DevOps/infrastructure teams deploying to production

**Architecture**:
```
Internet → Traefik (Coolify-managed) → Docker → n8n Stack
```

**Key Characteristics**:
- Runs on cloud server managed by Coolify
- Uses Traefik reverse proxy with automatic SSL
- Best for production workloads and team access
- Higher availability (no dependency on local machine)
- Scalable infrastructure

---

## Detailed Comparison

### Infrastructure

| Feature | WSL2 | Coolify |
|---------|------|---------|
| Host OS | Windows + WSL2 Ubuntu | Linux (Coolify server) |
| Container Orchestration | Docker Compose | Docker Compose (via Coolify) |
| Reverse Proxy | ngrok | Traefik (Coolify-managed) |
| SSL/TLS | ngrok-managed | Let's Encrypt (Coolify) |
| DNS | ngrok subdomain | Custom domain |

### Network Configuration

| Feature | WSL2 | Coolify |
|---------|------|---------|
| External Access | ngrok tunnel | Direct Traefik routing |
| OAuth Protection | ngrok Edge traffic policy | Traefik middleware or n8n auth |
| Webhook URL | https://your.ngrok.domain/webhook/* | https://n8n.aiwithapex.com/webhook/* |
| UI Access | http://localhost:5678 or via ngrok | https://n8n.aiwithapex.com |
| Inspector/Debug | http://localhost:4040 (ngrok) | Coolify dashboard |

### Service Configuration

| Service | WSL2 | Coolify |
|---------|------|---------|
| n8n Version | 2.1.4 (docker-compose.yml) | 2.1.4 (pinned) |
| PostgreSQL | 16.11-alpine | 16.11-alpine (tuned) |
| Redis | 7.4.7-alpine (port 6386) | 7.4.7-alpine (port 6379) |
| Workers | 5 (scalable) | 3 (individually defined) |
| Memory Limits | None (WSL2 config) | Per-container limits |

### Environment Variables

| Variable | WSL2 Location | Coolify Location |
|----------|---------------|------------------|
| `N8N_ENCRYPTION_KEY` | `.env` file | Coolify UI |
| `POSTGRES_PASSWORD` | `.env` file | Auto-generated by Coolify |
| `WEBHOOK_URL` | `.env` file | Auto-set via `SERVICE_FQDN_N8N` |
| `NGROK_AUTHTOKEN` | `.env` file | N/A (uses Traefik) |
| Database credentials | `.env` file | `SERVICE_USER/PASSWORD_POSTGRES` |

### Operations

| Task | WSL2 | Coolify |
|------|------|---------|
| Start Services | `docker compose up -d` | Coolify Deploy button |
| View Logs | `docker compose logs -f` | Coolify Logs tab |
| Scale Workers | `--scale n8n-worker=5` | Edit compose, redeploy |
| Backup | `./scripts/backup-all.sh` | Coolify backup or API |
| Monitor | `./scripts/system-status.sh` | Coolify dashboard + /metrics |
| Upgrade | Edit compose, restart | Edit compose, redeploy |

---

## When to Use Each Deployment

### Use WSL2 (Local) When:

- Developing and testing workflows
- Running personal automation tasks
- Need low latency for local integrations
- Learning n8n or prototyping
- Cost-sensitive (no cloud hosting fees)
- Machine is always on (home server scenario)

### Use Coolify (Cloud) When:

- Running production workloads
- Need 24/7 availability
- Multiple team members need access
- Integrating with cloud services
- Need centralized management
- Require audit logs and compliance

---

## Migration Path

See [migration-wsl2-to-coolify.md](migration-wsl2-to-coolify.md) for moving from local WSL2 to Coolify production.

### Key Migration Considerations

1. **Encryption Key**: Must be migrated exactly; credentials won't decrypt otherwise
2. **Webhook URLs**: External services must update to new domain
3. **Database**: Can be exported/imported or fresh start
4. **Credentials**: Re-enter if encryption key can't be migrated

---

## File Reference

### WSL2 Deployment Files

| File | Purpose |
|------|---------|
| `docker-compose.yml` | Main stack definition |
| `.env` | Environment configuration |
| `config/ngrok.yml` | ngrok tunnel configuration |
| `config/postgres/` | PostgreSQL tuning |
| `scripts/*.sh` | Operational scripts |

### Coolify Deployment Files

| File | Purpose |
|------|---------|
| `docker-compose.coolify.yml` | Coolify-compatible stack |
| `.env.coolify.example` | Environment template |
| (Coolify UI) | Environment variables |
| (Coolify UI) | Domain and SSL configuration |

---

## Related Documentation

### WSL2 Local
- [Installation Plan](n8n-installation-plan.md) - Complete setup guide
- [Onboarding](onboarding.md) - Quick start checklist
- [Tunnels](TUNNELS.md) - ngrok configuration
- [Runbook](RUNBOOK.md) - Daily operations

### Coolify Production
- [Deploy to Coolify](ongoing-roadmap/deploy-to-coolify.md) - Full deployment guide
- [Migration Guide](migration-wsl2-to-coolify.md) - WSL2 to Coolify migration

### Shared
- [Architecture](ARCHITECTURE.md) - System design (both deployments)
- [Environments](environments.md) - Configuration reference
- [Security](SECURITY.md) - Security hardening
